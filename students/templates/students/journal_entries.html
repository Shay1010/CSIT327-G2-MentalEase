{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MentalEase - My Journal Entries</title>
    <link rel="stylesheet" href="{% static 'students/css/journal_entries.css' %}">
</head>
<body>
    
    <!-- Navigation Bar -->
    <nav class="navbar">
        <a href="{% url 'dashboard' %}" class="navbar-logo">MentalEase</a>
        <div class="navbar-links">
            <a href="{% url 'dashboard' %}" class="nav-link">Dashboard</a>
            <a href="{% url 'about_us' %}" class="nav-link">About Us</a>
        </div>
        <div class="profile-dropdown-container">
            <div id="profilePic" class="profile-pic">{{ student.username|slice:":1"|upper }}</div>
            <div id="profileDropdown" class="dropdown-menu">
                <a href="{% url 'profile_page' %}" class="dropdown-item">My Profile</a>
                <a href="{% url 'logout' %}" class="dropdown-item">Logout</a>
            </div>
        </div>
    </nav>

    <!-- Page Container with dashboard-style background -->
    <div class="page-container">
        <div class="gradient-background"></div>
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>

        <div class="form-card">
            <header class="header">
                <h1>My Journal Entries</h1>
            </header>

            <!-- Action Bar -->
            <div class="action-bar">
                <a href="{% url 'dashboard' %}" class="journal-action-btn">Back to Dashboard</a>
                <div class="entry-count">
                    <span id="totalEntries">{{ journals|length }}</span> Total Entries
                </div>
            </div>

            <!-- Search and Filter -->
            <div class="filter-section">
                <input type="text" id="searchInput" placeholder="Search entries..." class="form-input">
                <select id="sortSelect" class="form-input">
                    <option value="newest">Newest First</option>
                    <option value="oldest">Oldest First</option>
                </select>
            </div>

            <!-- Journal Entries List -->
            <div class="entries-container" id="entriesContainer">
                <div class="empty-state" id="emptyState" {% if journals %}style="display:none;"{% endif %}>
                    <h3>No Journal Entries Yet</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Journal Entry</h3>
                <button id="closeEditModal" class="close-button">&times;</button>
            </div>
            <form id="editForm">
                <textarea id="editTextarea" rows="8" class="form-input"></textarea>
                <button type="button" id="cancelEditBtn" class="journal-action-btn">Cancel</button>
                <button type="submit" class="journal-action-btn">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- Delete Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Delete Entry?</h3>
                <button id="closeDeleteModal" class="close-button">&times;</button>
            </div>
            <p>Are you sure you want to delete this journal entry? This action cannot be undone.</p>
            <button id="cancelDeleteBtn" class="journal-action-btn">Cancel</button>
            <button id="confirmDeleteBtn" class="journal-action-btn">Delete</button>
        </div>
    </div>

    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
    <script>
    const supabaseUrl = 'https://YOUR_SUPABASE_PROJECT_URL';
    const supabaseKey = 'YOUR_SUPABASE_ANON_KEY';
    const supabase = supabase.createClient(supabaseUrl, supabaseKey);
    </script>

    <!-- Pass current student ID from Django to JS -->
    <script>
    const CURRENT_STUDENT_ID = "{{ student.id }}";
    </script>

    <!-- Your custom JS -->
    <script src="{% static 'students/js/journal_entries.js' %}"></script>

</body>
</html>
